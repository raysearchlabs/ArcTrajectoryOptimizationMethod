	
import numpy as np

from ruckig import InputParameter, Result, Ruckig, Trajectory  # pip install ruckig


def obj_rucking(xs, vels, EL_switches, irr_times):
	dead_times = []
	window = 1.0
	EL_switches = list(EL_switches)

	N = len(vels)

	t = 0.0
	#ts = [t]
	#min_durs = 0
	for i in range(1, len(xs)):
		otg = Ruckig(1)
		inp = InputParameter(1)
		trajectory = Trajectory(1)

		inp.current_position = [0]
		inp.current_velocity = [vels[i-1]]
		inp.current_acceleration = [0.0]

		inp.target_position = [2.0-(xs[i]+xs[i-1])/2]
		# print(2-(xs[i]+xs[i-1])/2)
		inp.target_velocity = [vels[i]]
		inp.target_acceleration = [0.0]

		inp.max_velocity = [5.0]
		inp.max_acceleration = [0.5]
		inp.max_jerk = [0.5]

		inp.min_velocity = [-1.0e-16]
		inp.min_acceleration = [-0.5]

		idx = i - 1

		inp.minimum_duration = EL_switches[i-1]

		if not otg.validate_input(inp, check_current_state_within_limits=True, check_target_state_within_limits=True):
			#assert False

			return 10000000 - i
		try:
			result = otg.calculate(inp, trajectory)
		except RuntimeError:
			return 10000000 - i + 0.000001*t
		if result == Result.ErrorInvalidInput:
			assert False
			return 10000000 - i
		t += trajectory.duration
		dead_times.append(trajectory.duration - EL_switches[i-1])
	print(t + sum(irr_times))

	return dead_times

if __name__ == '__main__':
	control_points = np.linspace(0.5, 358.5, 180)
	import matplotlib.pyplot as plt
	import seaborn as sns
	sns.set_style("darkgrid")

	palette = sns.color_palette("rocket_r")


	def obj_rucking_fancy(variables, control_points, EL_switches, irr_times):
		dead_times = []
		window = 0.5
		EL_switches = list(EL_switches)
		assert len(variables) % 3 == 0

		N = len(variables) // 3

		vels = list(variables[0:N])
		accs = list(variables[N:2*N])
		xs_ = list(variables[2*N:])

		# assert len(control_points) * 2 == N + 1

		xs = [0.5, control_points[0] - window + xs_[0] * 2 * window]
		for i in range(1, len(control_points) - 1):
			xs.append(control_points[i] - window + xs_[2*i-1] * 2 * window)
			xs.append(control_points[i] - window + xs_[2*i] * 2 * window)
		xs.append(control_points[-1]- window + xs_[-1] * 2 * window)
		xs.append(358.5)
		#print(xs)
		#assert False

		#xs = [0.0] + xs + [360]
		vels = [0.0] + vels + [0.0]
		accs = [0.0] + accs + [0.0]

		#print(len(xs), len(accs))
		assert len(xs) == len(accs)

		t = 0.0
		#ts = [t]
		#min_durs = 0
		for i in range(1, len(xs)):
			otg = Ruckig(1)
			inp = InputParameter(1)
			trajectory = Trajectory(1)

			inp.current_position = [xs[i-1]]
			inp.current_velocity = [vels[i-1]]
			inp.current_acceleration = [accs[i-1]]

			inp.target_position = [xs[i]]
			inp.target_velocity = [vels[i]]
			inp.target_acceleration = [accs[i]]

			inp.max_velocity = [5.0]
			inp.max_acceleration = [0.5]
			inp.max_jerk = [0.5]

			inp.min_velocity = [-1.0e-16]
			inp.min_acceleration = [-0.5]

			idx = i - 1

			# print(idx, len(EL_switches), len(irr_times), len(xs))
			inp.minimum_duration = EL_switches[(idx-1)//2] if idx%2==1 else irr_times[(idx)//2]
			# inp.minimum_duration = inp.minimum_duration * 0.99

			# min_durs += inp.minimum_duration
			# print(inp)

			if not otg.validate_input(inp, check_current_state_within_limits=True, check_target_state_within_limits=True):
				#assert False

				return 10000000 - i
			try:
				result = otg.calculate(inp, trajectory)
			except RuntimeError:
				return 10000000 - i + 0.000001*t
			#if result == Result.ErrorInvalidInput:
			#	assert False
			#	return 10000000 - i
			t += trajectory.duration
			dead_times.append(trajectory.duration - inp.minimum_duration)

			#if trajectory.duration > 4.0:
			#	print(trajectory.duration, inp.minimum_duration, idx%2==1, vels[i], vels[i-1], xs[i]-xs[i-1])
			#ts.append(trajectory.duration)
		#print(ts)
		#assert False
		#import matplotlib.pyplot as plt
		#plt.plot(ts, vels)
		#plt.show()
		#assert False
		return t, dead_times, vels, accs


	for case in [0]:
		#plt.subplot(3,1,case+1)


		if case == 0:
			# Prostate
			irr_times = [0.25573637372992614, 0.2600306215108128, 0.2728196146639798, 0.2583118248645355, 0.26404022104947833, 0.26146369783711815, 0.25395579920006867, 0.25049033197279474, 0.2329292068539457, 0.22556723368897352, 0.22071278583669574, 0.2132706365404427, 0.20028924738844056, 0.1729103248005005, 0.1312215904510094, 0.2482159231806481, 0.28284097142396925, 0.24739602662040067, 0.23275474459672185, 0.23512268094559677, 0.2549069415121, 0.21944159727677048, 0.20439736019001306, 0.19150392883746156, 0.18232772980045703, 0.18179560446802606, 0.1793022621535662, 0.14688110078647534, 0.13138770851756193, 0.09785786309564382, 0.20980131097809096, 0.2347518336596438, 0.2147809036082863, 0.223582309723098, 0.20741975925088835, 0.19764410334172738, 0.20516928041828625, 0.20112385670348298, 0.16658195647639168, 0.15450986760502225, 0.13006897470411288, 0.13540097297436843, 0.13908917078086988, 0.09473016071620173, 0.058971136328518345, 0.22080633082123588, 0.24277288002547842, 0.23432274570895562, 0.23297338192234263, 0.22156340044642114, 0.1898835330641028, 0.14812458987920243, 0.10939711749771962, 0.12059251801937962, 0.14233255230678724, 0.13875473994926207, 0.1167967196992374, 0.10818493378280679, 0.07572990600808442, 0.2157685396941731, 0.19120807600109477, 0.2103097892352499, 0.17812494977821366, 0.15858915414311123, 0.16320932625538423, 0.1659057984355071, 0.15391481805565532, 0.18587636171855065, 0.19130964040674064, 0.2021390437765941, 0.17169883587336057, 0.16057317299870413, 0.15083603918746297, 0.14008456612637207, 0.1271797979760788, 0.20531476583099956, 0.1835474924779004, 0.21488414218959387, 0.20912125813576213, 0.23454962115033764, 0.21361363430360059, 0.17498157728944913, 0.26377746002478714, 0.2610784794254208, 0.22399883636212695, 0.2588417120556742, 0.23830186759066155, 0.1935652239329664, 0.17023482336739287, 0.15359094063230644, 0.26456862254569957, 0.27517942011937346, 0.28383993453467476, 0.27298001005355066, 0.27180447348756537, 0.2774043449249782, 0.2608923295564658, 0.30612139675373756, 0.24791806569982325, 0.26789654735661156, 0.2755718560673665, 0.15814750942362243, 0.20916073546096964, 0.16202447877639337, 0.1024577662518249, 0.18950520309474297, 0.17888410395249835, 0.1715369124457999, 0.1597864542303803, 0.1625851235902527, 0.16163383822566063, 0.16984764139029368, 0.1585791099020009, 0.18567236320848507, 0.18843365032635187, 0.18951341020611787, 0.17916181399818218, 0.16136382893734957, 0.14545112258623016, 0.08783324804459013, 0.21987870640489232, 0.24236992726605744, 0.2598231772074893, 0.24247441710735704, 0.20264754659217846, 0.189781474770715, 0.21004480923158447, 0.11390438349922737, 0.13374965215300294, 0.14040100431338096, 0.15295322720972088, 0.14638193885057835, 0.09973259474583479, 0.0921847280281642, 0.07097019006951266, 0.2045750995738409, 0.22766767791371378, 0.24044087676439163, 0.2144492803597659, 0.20416647404869026, 0.21246095719060093, 0.18241861306194854, 0.19738886037760722, 0.19950591310931287, 0.21005482334726988, 0.18820463146176722, 0.15320705142127963, 0.14588042112502198, 0.13692973357177293, 0.09033087793927297, 0.2096933325860998, 0.24170923745872983, 0.23239275276721888, 0.24717660066169309, 0.24272428537431567, 0.2312099042068427, 0.22139884201094895, 0.17539363625021034, 0.180548963722436, 0.20308636847771355, 0.1988641746917169, 0.19454729013096522, 0.18878245473697247, 0.17750259993187156, 0.14912514156262316, 0.2393872882040612, 0.26916562619007955, 0.257701531436643, 0.2599030777565738, 0.2480569462379911, 0.2741302933927311, 0.24237480425696703, 0.2270580386715573, 0.20838237699435733, 0.20526078451782495, 0.20649720078296863, 0.2003490500966998, 0.16520570089959574, 0.17547039184510138, 0.17032794571239512]
			EL_switches = [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 5.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 0.0, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
			v0 = [0.0, 1.1176470588235294, 1.3333333333333333, 1.4901960784313726, 1.607843137254902, 1.7058823529411764, 1.7843137254901962, 1.8627450980392157, 1.8627450980392157, 1.7843137254901962, 1.6862745098039216, 1.5686274509803921, 1.411764705882353, 1.196078431372549, 0.7450980392156863, 0.7450980392156863, 1.1568627450980393, 1.3725490196078431, 1.5294117647058822, 1.6470588235294117, 1.7450980392156863, 1.8235294117647058, 1.9019607843137254, 1.9019607843137254, 1.803921568627451, 1.7058823529411764, 1.588235294117647, 1.4313725490196079, 1.196078431372549, 0.7254901960784313, 0.7647058823529411, 1.1764705882352942, 1.392156862745098, 1.5490196078431373, 1.6666666666666667, 1.7647058823529411, 1.8627450980392157, 1.9411764705882353, 1.9411764705882353, 1.8431372549019607, 1.7254901960784315, 1.588235294117647, 1.411764705882353, 1.1568627450980393, 0.5686274509803921, 0.9019607843137255, 1.2352941176470589, 1.4313725490196079, 1.5686274509803921, 1.6862745098039216, 1.7843137254901962, 1.8823529411764706, 1.9411764705882353, 1.8431372549019607, 1.7254901960784315, 1.588235294117647, 1.4313725490196079, 1.196078431372549, 0.7058823529411765, 0.7843137254901961, 1.196078431372549, 1.411764705882353, 1.5686274509803921, 1.7058823529411764, 1.8235294117647058, 1.9215686274509804, 2.0, 1.9607843137254901, 1.8823529411764706, 1.803921568627451, 1.7058823529411764, 1.5686274509803921, 1.392156862745098, 1.1372549019607843, 0.47058823529411764, 0.9607843137254902, 1.2745098039215685, 1.4705882352941178, 1.607843137254902, 1.7254901960784315, 1.8235294117647058, 1.9019607843137254, 1.9215686274509804, 1.8431372549019607, 1.7647058823529411, 1.6666666666666667, 1.5490196078431373, 1.392156862745098, 1.1568627450980393, 0.6274509803921569, 0.8431372549019608, 1.196078431372549, 1.392156862745098, 1.5294117647058822, 1.6470588235294117, 1.7450980392156863, 1.8235294117647058, 1.8823529411764706, 1.8823529411764706, 1.803921568627451, 1.7254901960784315, 1.607843137254902, 1.4509803921568627, 1.2549019607843137, 0.8823529411764706, 0.6078431372549019, 1.1372549019607843, 1.3725490196078431, 1.5490196078431373, 1.6862745098039216, 1.803921568627451, 1.9019607843137254, 1.9803921568627452, 1.9019607843137254, 1.803921568627451, 1.7058823529411764, 1.588235294117647, 1.4313725490196079, 1.2156862745098038, 0.7843137254901961, 0.7058823529411765, 1.1568627450980393, 1.3725490196078431, 1.5294117647058822, 1.6470588235294117, 1.7647058823529411, 1.8627450980392157, 1.9411764705882353, 1.9411764705882353, 1.8431372549019607, 1.7254901960784315, 1.607843137254902, 1.4509803921568627, 1.2156862745098038, 0.7647058823529411, 0.7450980392156863, 1.1764705882352942, 1.392156862745098, 1.5490196078431373, 1.6666666666666667, 1.7647058823529411, 1.8627450980392157, 1.9411764705882353, 1.8823529411764706, 1.803921568627451, 1.7058823529411764, 1.5686274509803921, 1.392156862745098, 1.1568627450980393, 0.5686274509803921, 0.9019607843137255, 1.2352941176470589, 1.4313725490196079, 1.5686274509803921, 1.6862745098039216, 1.7843137254901962, 1.8627450980392157, 1.9411764705882353, 1.9019607843137254, 1.803921568627451, 1.7058823529411764, 1.588235294117647, 1.4313725490196079, 1.2156862745098038, 0.8235294117647058, 0.6470588235294118, 1.1372549019607843, 1.3529411764705883, 1.5098039215686274, 1.6274509803921569, 1.7254901960784315, 1.803921568627451, 1.8823529411764706, 1.8627450980392157, 1.7647058823529411, 1.6666666666666667, 1.5294117647058822, 1.3725490196078431, 1.1372549019607843, 0]
			#xs0 = [0.0, 0.2906224593356143, 0.36375948621863974, 0.38493526842558234, 0.42453525737367104, 0.44602630807508387, 0.4531368181805147, 0.46659963798853926, 0.43388773825734983, 0.40248271109209005, 0.372182344744232, 0.33454217496540034, 0.2827612904307396, 0.2068143100555006, 0.09777294974781092, 0.18494519766401232, 0.32720818262772916, 0.3395631737927068, 0.3559778446773393, 0.3872608862633358, 0.4448376038152334, 0.40015820679881675, 0.38875576349865226, 0.36423296269085825, 0.3289049243459225, 0.31012191350427976, 0.2847741810674287, 0.21024157563554313, 0.15715000430531917, 0.07099492028507493, 0.16043629663030484, 0.27617862783487507, 0.29900870894486914, 0.34633338172793615, 0.3456995987514806, 0.3487837117795189, 0.38217807136739596, 0.3904168983067611, 0.323364974336525, 0.2847828932327861, 0.22443274066592028, 0.2150486041357616, 0.19636118227887514, 0.10958979376972358, 0.03353260693190259, 0.19915865132895785, 0.29989591061970866, 0.3354031458187012, 0.36544844223112566, 0.37361671447827877, 0.3388117942908501, 0.27882275741967516, 0.21235911043674985, 0.22226856262395459, 0.2455934235881819, 0.22037517521353386, 0.16717961839302609, 0.12939766589708263, 0.053456404241000774, 0.16923022721111614, 0.22869985560915257, 0.29690793774388224, 0.27941168592660964, 0.2705344394206015, 0.2976170067009948, 0.3187993773858764, 0.30782963611131064, 0.3644634543500993, 0.36011226429504123, 0.36464298093032665, 0.2928980141369092, 0.2518794870567908, 0.2099874271041151, 0.15931185951626628, 0.05984931669462532, 0.19726320638664663, 0.2339330786483044, 0.31600609145528513, 0.336234179747696, 0.40471307178881794, 0.38953074490656575, 0.3328080979818934, 0.5068664918123361, 0.48120347188214807, 0.3952920641684593, 0.43140285342612367, 0.3691342654835738, 0.26947315488707085, 0.19693832507208198, 0.09637078627909423, 0.22306766214637416, 0.32913616916238786, 0.3951497127835668, 0.4174988389054304, 0.4476779563324606, 0.48409777839849133, 0.47574483625002584, 0.5762285115364472, 0.46666930014084373, 0.48326435993741695, 0.4754965359593775, 0.2542763877007263, 0.30348812596297553, 0.20332483611155244, 0.09040391139866903, 0.11518943717523591, 0.20343682410284125, 0.2354428210040391, 0.24751235067058908, 0.2741631495835634, 0.2915747669953094, 0.3230435532325193, 0.31404882549219787, 0.35314155355339316, 0.33991952607890924, 0.3232875821163187, 0.28455111635005403, 0.23097175514561802, 0.17682293334012292, 0.06888882199575697, 0.15520849863874753, 0.28038873938622333, 0.35662004714753437, 0.3708432261641931, 0.3337724296812351, 0.33490848488949704, 0.3912599387647162, 0.221108509145559, 0.25963167770877044, 0.2587783216756433, 0.26391929400893016, 0.2353591957989691, 0.14471003943513283, 0.11206770858325843, 0.05427132181786262, 0.15242850556482263, 0.26784432695731036, 0.3347314166719962, 0.3321861401651276, 0.3402774567478171, 0.37493110092458987, 0.33979937727225706, 0.3831666113212375, 0.37554054232341244, 0.3789224264303692, 0.3210549595524264, 0.24032478654318373, 0.20308842940934432, 0.15840890746538439, 0.05136461686742973, 0.18913516272471745, 0.2985819992137251, 0.3326406069020976, 0.3877280010379499, 0.40929977533708134, 0.41255100554554286, 0.41240960766745394, 0.34046999977982007, 0.34339704864855475, 0.36635188039116956, 0.3392388862388112, 0.30898687256094476, 0.27021802344703905, 0.2157874744269811, 0.12280894011039553, 0.15489765707321607, 0.30610992782401203, 0.34865501312016406, 0.392402686024631, 0.40370052034810316, 0.4730091336972615, 0.43722513709099936, 0.42740336691116665, 0.388163251263999, 0.3622249138549852, 0.34416200130494773, 0.30641619426554084, 0.2267529228033667, 0.19955456327482118, 0.0]

			brute_force_sol = [0.013935370910857324, 1.2600304959533202, 1.3901659521184788, 1.762003673743992, 1.7895422610257168, 1.6817490183152026, 1.6965965605848579, 1.9011612643349507, 1.9357509890583129, 1.8701865408856988, 1.8835235571366316, 2.0691139228668076, 2.128564345832934, 2.1317766180860485, 2.14044460221468, 2.2272906261590775, 2.2011579404095607, 2.006289395507783, 1.9795421513804465, 1.8672922869437245, 1.853155470196888, 1.867697514352052, 1.821412015230059, 1.5394523638930568, 1.5216535553086485, 1.327942133743193, 1.2988510498804915, 0.781456519405962, 0.7449909459971042, 0.772553487175457, 0.8495484694036182, 1.3099775576159383, 1.3734212883016748, 1.7328386670253593, 1.7654920941899024, 1.6534777326154024, 1.661376929836186, 1.8810394428936152, 1.9832257838952139, 2.1254591277104065, 2.0888634414170215, 1.9624194875892946, 1.9680683269024275, 2.1135984740945815, 2.125134564276572, 2.0207659483194615, 2.0144073012931654, 2.057223480246042, 2.0264612043175068, 1.8261283266956228, 1.8140419984520935, 1.7067196835830505, 1.6883099584967982, 1.516004581377157, 1.5040348683589253, 1.25612825822997, 1.2400514538201928, 0.7475598139296502, 0.7260785758174496, 0.7710167281411253, 0.833403420700895, 1.4239654235029884, 1.5050849689080894, 1.5421668148237804, 1.55660944044872, 1.7285608588196748, 1.7585103994205808, 1.9711169497949217, 1.973368464408374, 1.8567110553579678, 1.8635788484213078, 1.9725791084709692, 2.0014514878732803, 2.1951027088523714, 2.2125772354959334, 2.0917469988469994, 2.0827677933620965, 2.0403325413600126, 1.9961039317760274, 1.771408360907896, 1.7640834081186303, 1.6417291566752024, 1.6349432905852805, 1.4579265737273734, 1.446264537994808, 1.1794582386895562, 1.1720451097772364, 0.574395749002536, 0.565678618264857, 0.9245893032482526, 0.985526880249097, 1.368575789638604, 1.4182002607020359, 1.6217957952871591, 1.6411439380113353, 1.7184892106189993, 1.7282345230718255, 1.7958674804545016, 1.8164530454300314, 2.0081845380177166, 2.0257860683758064, 1.9292122501666193, 1.9308054694250745, 1.9869017471759345, 1.9855472042758635, 1.8956982270543814, 1.8878758884131805, 1.7873782855836289, 1.7803389316396039, 1.6862238000926648, 1.6724673501726335, 1.4730057685371285, 1.4656322350834583, 1.2250108581915153, 1.2163311019658822, 0.7171788376484413, 0.7037296264249832, 0.8009951506386802, 0.8620097141477172, 1.2608355168174001, 1.2838791161360077, 1.6633778148263245, 1.709948852458183, 1.6507976460946618, 1.656426081837764, 1.7868970507558632, 1.802352468892036, 1.885918452825012, 1.891785133016584, 2.0777388373413355, 2.1057751920587275, 2.0685049164669524, 2.0696087613620913, 2.179952209128137, 2.1737188823462907, 2.03732208565904, 2.0276987735295244, 2.093958831209025, 2.0726860286181337, 1.8575455893042547, 1.8332121411641387, 1.6679268074213014, 1.658893396876093, 1.4927800428988354, 1.4779882300456095, 1.2005958706037527, 1.1839149387861323, 0.4992343898970048, 0.4680106054267443, 0.9891530210033813, 1.0595592855176437, 1.3640667581787291, 1.3844258200432835, 1.7256711866359713, 1.7646957032786668, 1.7116769725256196, 1.7230146776161923, 1.941432762756255, 1.9821240977203574, 1.9475449357158476, 1.958297215568149, 2.1511782956450918, 2.230458722842219, 2.3974308196996765, 2.390903874502464, 2.226577652486168, 2.106327536118601, 1.9278023613044586, 1.9179601679627836, 1.9773482247085807, 1.9386528669377214, 1.7010311856422191, 1.67586426768965, 1.5209006406133787, 1.5037208952612975, 1.2581366665621814, 1.234229853056352, 0.6635397393968699, 0.6256237082140742, 0.856727313442825, 0.9348255349890504, 1.4684358238757234, 1.5552791333139555, 1.5773766126599984, 1.6052498604029661, 1.8608903145417888, 1.9040381692300083, 1.8568243379813063, 1.8730611274853306, 2.052932965597451, 2.1071854663569445, 2.0890935491549643, 2.1018228537114365, 2.2497126562598786, 2.312265811935179, 2.266224166729338, 2.1890906325625488, 2.0232333244855885, 2.009352033424898, 1.9931294816987493, 1.9191395710557062, 1.6793041407144615, 1.6686513159458856, 1.5365092310833792, 1.524747070120254, 1.4153238352315456, 1.3810308480115647, 0.9052961908992461, 0.8820369806790372, 0.6185368485643775, 0.6809053137373076, 1.21558859157321, 1.2390433360304156, 1.4303011261409393, 1.4396948473378812, 1.6129075398516455, 1.6275796754324368, 1.7533144864660477, 1.7649325618469605, 1.995565521937412, 2.0243495449224262, 1.9995257011405048, 2.009065048890267, 2.098996901945798, 2.105173346459767, 2.139569992741135, 2.1009094035393634, 1.9120096665427306, 1.9022085363124286, 1.8680209332820636, 1.8470153471267772, 1.6921422262809447, 1.675120142183323, 1.523051489066403, 1.5161564386336135, 1.3673752318808503, 1.3389622676842339, 0.8028235556687746, 0.7842549669217016, 0.7189842426813453, 0.7808140548192629, 1.3046510115874745, 1.3684222172844458, 1.6253146220611563, 1.6651804005937914, 1.7207175151623282, 1.7269928350635226, 1.7695453781263777, 1.7796390890090366, 1.8755285704060611, 1.892671376621737, 2.0651697127084034, 2.071433722393471, 1.9691860098059581, 1.9715496840918245, 2.100328057624896, 2.0945058000938683, 1.9208782975312306, 1.9067200871016365, 1.7768362215392401, 1.770654965195632, 1.7472312972088901, 1.7167770905625719, 1.482715078874974, 1.4773460218685786, 1.2360756321330877, 1.2309920554832934, 0.7799162521067031, 0.7665293923525223, 0.7529655568081381, 0.8133890054176509, 1.3085141649221506, 1.3567382766916736, 1.5670634997137685, 1.588754904980661, 1.8252495720223991, 1.8355247053988164, 1.7205246176974776, 1.7297485497056508, 1.950920046068072, 2.000372351376589, 2.0048302437566514, 2.0141091151510175, 2.1653068663177693, 2.172772094106755, 2.045003096984862, 2.0324761242970255, 2.061898284976739, 2.0281773626801667, 1.8351794486690851, 1.8226447259674892, 1.794557519165648, 1.7500288919444127, 1.4681797358722435, 1.4592538859097113, 1.2279740228575466, 1.2094342903351405, 0.5854868349849219, 0.566473295028491, 0.9214950731640806, 0.9737466959709361, 1.4857450208086445, 1.5554844905621303, 1.5457217534961343, 1.5594370771846662, 1.8325593461769019, 1.9449930141234137, 2.10096859514911, 2.074916182136248, 1.950621631176228, 1.9597220719954251, 2.122509018853713, 2.1772124996975117, 2.1495779782359583, 2.1338551053891064, 2.0341029403468456, 2.0274589431403056, 2.060206033742555, 2.024391051269227, 1.8270926359264426, 1.815103741107887, 1.855135614110321, 1.8197960219181066, 1.543964892048847, 1.5287982002157934, 1.3370848761607756, 1.3132253142240817, 0.8705291547467252, 0.8251635843419645, 0.6515633865771118, 0.7333404380336062, 1.3881881658914517, 1.4980388615758067, 1.5910940893839276, 1.6110706396193453, 1.700638210327104, 1.7260958662327772, 1.9857313619533918, 2.0727189819465273, 2.135194826036862, 2.0769040758772275, 1.9671113329847416, 1.9799944374027658, 2.1546780943738306, 2.220995381156893, 2.234721020340921, 2.181370828735, 1.920448892340164, 1.8932888698036172, 1.7725779748287382, 1.7637835303840197, 1.8041168890101644, 1.7644599946700814, 1.4731565123944625, 1.462509644865352, 1.3408919736492386, 1.264394080957072, 0.0020788008813857404, 0.11803263652659422, 0.4991711261968119, 0.5, 0.16895766332520984, 0.03287234166035955, -0.0071352751435445625, 0.12201899929556438, 0.19640273837151528, 0.06365415532601805, -0.014390854202197153, 0.11637610872220125, 0.29753660815024197, 0.170740654079574, -0.02810827336830792, 0.09724289451377348, -0.05413066487299735, -0.16982998861214219, -0.17492714446474508, -0.06223168881056703, -0.1190616786876905, -0.008981652254571386, -0.16387798704299947, -0.2700589016186779, -0.13891875051302524, -0.03878165452792642, -0.20826347997704997, -0.11963670989679745, -0.31023697991885407, -0.25220910198642327, 0.25654854258510523, 0.3720600526478563, 0.1531123976198083, 0.29471224499087434, 0.19382798462317083, 0.07142170229833983, -0.024540103286925442, 0.09218820612112921, 0.4741732562631414, 0.3770301181043394, 0.005335560399620111, -0.19130691509679035, -0.029117321951913553, 0.0805671206363255, 0.10936465217446519, -0.021126505559174915, -0.0811236505105018, 0.014951988834030308, -0.12353259905353646, -0.2142493441628731, -0.11190586680371244, -0.021082787755308138, -0.14573442883476675, -0.05338842703909468, -0.11819756175662861, -0.044784692931077674, -0.15466182773542717, -0.08881448976416623, -0.24366384968494761, -0.2024401686313553, 0.2472999784770915, 0.3497780265484764, 0.40275869398113034, 0.28840867261540987, 0.013211902053411377, 0.12057493888280256, 0.07550170769546569, 0.1887495117687218, 0.10127828982708616, -0.0893327409538726, -0.016194957183977468, 0.08443881645281488, 0.0896679359507917, 0.19139536197235135, 0.13549440488147116, 0.037155145104787804, -0.09551994739676363, -0.012097130338361978, -0.24710522622248246, -0.3241676917906902, -0.08881575063777487, -0.023821766668394594, -0.08384716339124351, -0.01636778515724539, -0.11735425581557363, -0.046040660461054594, -0.10112459114915848, -0.05330031447170976, -0.1619650892800507, -0.14070327876972938, 0.23391954264441056, 0.3305052212502594, 0.1393866430600063, 0.26274618167070024, 0.024010128547978765, 0.14111813972330464, -0.016379607473956264, 0.0999913198196673, 0.0375180997153581, 0.14829153103049325, 0.1398420078611334, 0.04540644530626667, -0.02611799614425027, 0.04774746387960204, -0.03961500961521316, 0.015126227088240598, -0.09478247513403741, -0.034332821620089146, -0.08501063818652792, -0.013771835216291346, -0.13200140866908838, -0.060717118796941125, -0.09231486071480385, -0.03393990248111032, -0.1066338409602778, -0.05193402930875536, -0.196431273665822, -0.1623132684244903, 0.23511165562792413, 0.33640246876886043, 0.06901009337127649, 0.16657701137506298, 0.27252211474705623, 0.1696213039563995, -0.014026505381187097, 0.07633132879954886, 0.05575698195474612, 0.13623952131727565, -0.004816413789056942, 0.07670516168711115, 0.20736131987542045, 0.12367033970073839, -0.031309678852646496, 0.04565661868894864, 0.04188066367783931, -0.08910294296836602, -0.09810600226634811, -0.0022318160725603243, -0.05494357180350104, -0.1553963318335183, -0.18357819882117465, -0.09766695384062278, -0.09632331495203957, -0.01602070220726257, -0.13329534571886054, -0.05482214783052761, -0.15259368581611327, -0.08143316783602603, -0.2768746622490623, -0.22332385106619615, 0.3051494055195502, 0.39365657008518545, 0.06442541707760653, 0.15653255315296524, 0.23503166284067523, 0.12795928562004566, 0.0019309519157401772, 0.10649555371563564, 0.23207944192420388, 0.11502697233221752, -0.0030791408807375642, 0.1037303663793405, 0.45067652938996444, 0.4179068349595685, 0.08799830319881352, -0.11946087546787644, -0.422278161390172, -0.4335946945369638, -0.09992541322615194, 0.012091676717441142, -0.08511394378085187, -0.2137443912509045, -0.16497839119299212, -0.04585899003330392, -0.13640619462817496, -0.0385551396495967, -0.1827914582594115, -0.0975786016886471, -0.2849604763996824, -0.21748370137274448, 0.24555263528638901, 0.36072916953589546, 0.38343492585810557, 0.2467795068625802, 0.027310427894012074, 0.16914537291660764, 0.22624979397334063, 0.0899066132220916, -0.008117980557461732, 0.1276819564803658, 0.26475161880910514, 0.1265920011064778, -0.016485971248481793, 0.11401133762128612, 0.2807219681653146, 0.12787712081554586, -0.24945239204107145, -0.37273630267886915, -0.11881349258895253, 0.015219286631891489, -0.19919102982023715, -0.3370641326300793, -0.10687984983167059, -0.02791092344389334, -0.10836668386774216, -0.003247398916136567, -0.2496282291251956, -0.16748258218422168, -0.2517935661488381, -0.2133214417226897, 0.29598337397303187, 0.375899184340517, 0.07931905177371001, 0.172261560119838, 0.011734173397400616, 0.09760622966237548, 0.04734538759691061, 0.1299989849277071, 0.030868480897534502, 0.11191442006807052, 0.21754641724937404, 0.13698319485766336, 0.013420253505474813, 0.09852973970495216, -0.0005785997732297319, 0.07840106978944103, -0.16164557819604833, -0.2535787744030209, -0.09910794851622005, -0.005174363267845469, -0.15469176323648937, -0.054171858497119446, -0.13951083103108092, -0.049812042851250876, -0.08305192137693466, -0.0021832832560334716, -0.22794352643033142, -0.15416985106163872, -0.2332381543276929, -0.19348486894649372, 0.23169257593230708, 0.3353991799162581, 0.20260162642122712, 0.3235540493440791, 0.0885699747391426, 0.21813836141051238, -0.034958564054482805, 0.08663688821530072, -0.0011596984969361706, 0.10038821641413112, 0.042547858622482684, 0.13759269607212313, 0.10214977045475718, -0.06437558797141484, -0.007837444704110724, 0.04923748182559124, 0.02396299582908819, -0.07979558262084878, -0.1358797869137767, -0.06572851890675359, -0.07856859316099188, -0.0022270491437821473, -0.2426348465295451, -0.17345124187261562, -0.07873016459349265, -0.028850198384743515, -0.07816840812412638, -0.032095735895693145, -0.20606856141627394, -0.17673247077769913, 0.2502274192066706, 0.3420355061655154, 0.15322334207101523, 0.26773315387665103, 0.029862625812401133, 0.15018904439427833, 0.10566155369331538, -0.02981457377449513, -0.00585976063723302, 0.09620421425738569, 0.2852354472466231, 0.1788581698133867, 0.005246902453606031, 0.09645460439339841, 0.09253972236122152, -0.033001501985748645, -0.11266232697627504, -0.0129151791002581, -0.10803904285520897, -0.21288097771946454, -0.11363121113441334, -0.01946187492420041, -0.25277555036670685, -0.32825543837309046, -0.09764856223054817, -0.02473076661863789, -0.1670007645342938, -0.09687643502707141, -0.23261018232497946, -0.19559256190144533, 0.2103855910798125, 0.3007111802966576, 0.3464918455705567, 0.22888808411685288, 0.0008604695897571461, 0.11711143210596676, 0.5, 0.3951368480356665, 0.020446202590415002, -0.1625581274330277, -0.018518041222818738, 0.09714349519318946, 0.30115255482670117, 0.19188435918249186, -0.1305429562306594, -0.04541361399018379, -0.08195231051883863, 0.008654690386187472, -0.12537333756785407, -0.22671519268488874, -0.10998332835052647, -0.010485648572631677, -0.13327797562785082, -0.23010171106704083, -0.12748123463185806, -0.033121139495626534, -0.17761608763456904, -0.08769322837129748, -0.3399439289406206, -0.27007805833989057, 0.2860139710766463, 0.4013786647514046, 0.4734399340780796, 0.34150880299716996, 0.013034385975064742, 0.1419256559476318, 0.03296805135673097, 0.16285809175468102, 0.4109723704371702, 0.2885316508458975, -0.1442528504157629, -0.2804793112420108, -0.007518681140306967, 0.11374800278316008, 0.34817583501024096, 0.23587057357887845, -0.20496218518806358, -0.30565932647574773, -0.18358669426263205, -0.0810533024008345, -0.09425569019445805, 0.009493334609274918, -0.1480397961103437, -0.24794890511532616, -0.10574492923502696, -0.02314684457813398, -0.3919362732395731, -0.47950030594983745, -0.045586506648169677, 0.5010971957700682, 0.10851726995167908, 0.4535466837419558, 0.0, 0.4853170149679914, 0.1998453006564684, 0.6355968645148793, 0.06867573585392378, 0.5796172052694178, 0.19641651046649286, 0.6865498451580707, 0.03885642116000999, 0.5726531855315845, 0.17846371099535707, 0.7134575788679125, 0.48368797762100674, 1.0, 0.550941101568922, 1.0, 0.38693285908228486, 0.7970689302088523, 0.5296032953431097, 0.9236319504901407, 0.44345520880837586, 0.7496999892034377, 0.5532889041403481, 0.7861081693792961, 0.4464148663136621, 0.5464742658269619, 0.41591667802298093, 0.616599889609666, 0.06983668262834482, 0.4490344021049098, 0.0, 0.43338849473144125, 0.2665273700059684, 0.6530721775950357, 0.0, 0.45480241756765916, 0.0, 0.8337389831819669, 0.25090917332000356, 0.6817263892698054, 0.24189230435752657, 0.7967248144267697, 0.33448369956681717, 0.7219310048765646, 0.5689015383630499, 0.9414635698022259, 0.4487277884799973, 0.7794883856549398, 0.6654115519096164, 0.9792936707020435, 0.494124301373374, 0.7157897933125388, 0.5957645332995326, 0.7604941499727421, 0.4581380120413904, 0.5302058699249667, 0.4312414626722916, 0.5991617949977819, 0.0, 0.3443362638198576, 0.23940046996943304, 0.5728207842213625, 0.030714844290009355, 0.425610585601362, 0.03434833214708409, 0.7921461325859979, 0.29702181384216886, 0.6710887769138638, 0.0, 0.40742294649435473, 0.0, 0.44358370370146194, 0.41553573121179205, 0.7636650123542258, 0.6563650514389476, 0.9689385795109879, 0.4918432110824206, 0.7217462861639342, 0.5052792527711838, 0.7270512110799658, 0.5846050501587545, 0.7918083082990309, 0.569351368222624, 0.6822189137069836, 0.48092339600155004, 0.5145315137773027, 0.41952515614618446, 0.6299927963154995, 0.09363194593741436, 0.4369210927741131, 0.13157257265833988, 0.5136332475914608, 0.2599883776675987, 0.6611940347027686, 0.21164211399316515, 0.6113970349840266, 0.12309326213303061, 0.5065084949427241, 0.35533659838560744, 0.6411591437257992, 0.41407965794898527, 0.6321934985809461, 0.4961847393729448, 0.7254160464605465, 0.4711579543096345, 0.7252689177582492, 0.6094142704305018, 0.8491659966813085, 0.47929385163282134, 0.6508460922393847, 0.5421258221973497, 0.675711535269003, 0.46573216213074176, 0.5195172285454, 0.42968654687012275, 0.6086958363350572, 0.16643578433829684, 0.4150583292797948, 0.0, 0.3551755012267341, 0.3199385544906759, 0.6188116855325697, 0.0785711799218179, 0.3673501514440287, 0.26126514167923737, 0.5702903200594615, 0.1532565017225685, 0.5070505418128293, 0.2735050724525412, 0.5919035715431481, 0.2510649012275535, 0.8252775769248437, 0.37462817818393124, 0.7641474809035156, 0.5464197970308771, 0.968095745099464, 0.5435365737885247, 0.8622647414608883, 0.46738582393294387, 0.73480647145723, 0.6199463247523354, 0.8535805303881943, 0.5508145228685812, 0.7207754969256721, 0.4634312538719763, 0.5248566881676944, 0.42252912732466297, 0.6325233790068419, 0.23532148086468926, 0.48834722338078507, 0.11367216242391173, 0.4891082475934092, 0.2516024228833573, 0.6103777816776894, 0.11916056094646947, 0.5798973889769901, 0.24543649691430008, 0.6622577421609578, 0.07645788956678015, 0.4599624246604249, 0.0, 1.0, 0.4101435437931463, 0.9764635117443313, 0.3124466663140153, 0.7429266880128731, 0.4606589179875754, 0.968683327480439, 0.4546722230041567, 0.8570837719784817, 0.6496343400388294, 0.9459997553266957, 0.553994949818244, 0.7663389892106638, 0.44517409354350207, 0.544028650053458, 0.4042262995179957, 0.6404679564839182, 0.0, 0.41772092342833483, 0.19340111553053724, 0.6441270257729476, 0.10770558776221635, 0.6224347850461178, 0.19011270457835094, 0.6962783757904528, 0.013232246320961656, 0.5912248269921644, 0.16453483479424966, 0.7107772837901286, 0.0, 0.6999239967485621, 0.4470700822603478, 1.0, 0.28495804499561245, 0.8252208574727408, 0.44877676090315477, 0.9895009243451548, 0.4486956173106435, 0.7132846526877823, 0.4016833495525312, 0.7235115054597, 0.6108432909721672, 0.8405897391603645, 0.44434083168531824, 0.5358637685184848, 0.4476026128979945, 0.5704554548374318, 0.15344012340650268, 0.38217628687947935, 0.2762102159059524, 0.5225295383853524, 0.16126970300791385, 0.4292708756457075, 0.2342407851401604, 0.5201856202326337, 0.13827565934010164, 0.4647880295720335, 0.27399121846368274, 0.6151953698345916, 0.25027110055498325, 0.5834878264440574, 0.5093403570836479, 0.9035844148216967, 0.38874419203247634, 0.7479829039275764, 0.6266366825273951, 1.0, 0.5734750946715463, 0.8757751457193419, 0.49326815629653376, 0.7391672935049848, 0.5749938377970307, 0.7761395848909738, 0.4534987554131112, 0.5231701651847706, 0.4271132054219843, 0.5915684924701456, 0.0, 0.32335046338686635, 0.0, 0.4268207532029064, 0.2685193947292526, 0.6875754140180314, 0.22394129566096663, 0.5843093582145409, 0.18443741202208638, 0.5427504465386894, 0.11276623260949324, 0.8044486952251657, 0.3729271710490544, 0.5978193453118015, 0.3932567301255256, 0.8335286768467929, 0.5021643609833638, 0.7709135839457121, 0.39899729021239533, 0.6704376923719585, 0.7092181905961656, 0.9647668486258463, 0.5080041295779009, 0.6556692256140828, 0.5368592199840403, 0.6505657684263653, 0.46739724053231174, 0.5222590993969236, 0.43197792245222105, 0.592140237329965, 0.06436951099246484, 0.36920788846201164, 0.16025068764154754, 0.5397158197964455, 0.18184804367209645, 0.6800925625979528, 0.2637340363350247, 0.615605375543325, 0.10352568755885792, 0.5248883023121961, 0.2174610369936587, 0.5839087181347905, 0.2246593248734707, 0.7715949946552587, 0.40742267056557835, 0.8138446227647058, 0.4936146356730484, 0.9236186077428992, 0.39372624209202806, 0.7379381305445972, 0.7283243972747042, 1.0, 0.48182999863413234, 0.695247477532944, 0.5606100783040291, 0.7316853054741314, 0.47013808811722496, 0.5221376155214393, 0.41898694323685304, 0.6173291887744217, 0.02655705497592084, 0.3966395837550506, 0.23972094564062224, 0.6001949982062919, 0.0, 0.46748019501814286, 0.003363239549560277, 0.7716043942912529, 0.24620219362781615, 0.6980963032181035, 0.02369820866475235, 0.5001707640948393, 0.5475593037732779, 0.925796825774828, 0.3574862380582208, 0.7253440271184998, 0.48924279606823445, 0.9048039624959592, 0.3812196479187806, 0.7433984721307927, 0.5346310290536319, 0.8924352773816806, 0.47267148198817077, 0.7624864870321315, 0.5350791237775152, 0.7731837892637731, 0.42229692604341973, 0.5486187401795382, 0.4282898299828571, 0.5934836875588779, 0.0, 0.38925960094843853, 0.20813567799119248, 0.6202843427610965, 0.15925939523703112, 0.6039130859308884, 0.0, 0.5058988999840989, 0.3543417734402582, 0.9328299671561636, 0.24031963351072683, 0.7184001226370044, 0.04802130606764791, 0.5456547469850145, 0.539460435320929, 1.0, 0.5992827408553111, 0.9905181136313839, 0.35682962198921625, 0.7234108728172511, 0.49629352628979095, 0.854129791834787, 0.4540897165847231, 0.6964044730450005, 0.6504295185486941, 0.8793446153968021, 0.49993673569358815]
			control_points = np.linspace(0.5, 358.5, 180)

			_, fancy_dead_times, fancy_vels, fancy_accs = obj_rucking_fancy(brute_force_sol, control_points, EL_switches, irr_times)
			print(len(fancy_dead_times), len(fancy_vels), len(fancy_accs))
			print(fancy_vels)

			fancy_dead_times = [fancy_dead_times[i*2+1]+fancy_dead_times[i*2] for i in range(len(fancy_dead_times)//2)]
			#fancy_vels = [0.5*(fancy_vels[i*2+1]+fancy_vels[i*2]) for i in range(len(fancy_vels)//2)]
			fancy_vels = [fancy_vels[i*2] for i in range(len(fancy_vels)//2)]
			fancy_accs = [0.5*(fancy_accs[i*2+1]+fancy_accs[i*2]) for i in range(len(fancy_accs)//2)]
			#plt.scatter([i+0.5 for i in range(len(fancy_dead_times))], fancy_dead_times, s=2)
			#plt.scatter(list(range(len(fancy_vels))), fancy_vels, s=2)
			#plt.scatter(list(range(len(fancy_vels))), fancy_accs, s=2)
			#plt.show()
			# plt.plot([dead_times[i*2+1]+dead_times[i*2] for i in range(len(dead_times)//2)])
			# plt.show()

		if case == 1:
			# H&N
			irr_times =[0.28340634814147214, 0.3242099889460033, 0.332090167863834, 0.32337869122593127, 0.26920055786019986, 0.25690316345751635, 0.26726439348567155, 0.30234799315815597, 0.3607970278915356, 0.38609747297100055, 0.44383091069078484, 0.4798909606270815, 0.5329546495130836, 0.6043520444209806, 0.5665853207471516, 0.46920884312559263, 0.4677723793403241, 0.17557857648912437, 0.16052209905699502, 0.21048134047469638, 0.3075165241183208, 0.32644482844528705, 0.33909765464831637, 0.4860614654295671, 0.5051756447413822, 0.5550327868122917, 0.5442110037429368, 0.5223212779696814, 0.5670024785907175, 0.4923765681701511, 0.45987315537777185, 0.46714630328665085, 0.2893437838607894, 0.3325701602426019, 0.45549294539142743, 0.5282183301080516, 0.49343574292697007, 0.5450266521734182, 0.517341906015737, 0.5527819343142535, 0.46005510097770025, 0.4091041360661238, 0.4453752556285654, 0.4995062932058607, 0.4760233045367538, 0.47972996819595265, 0.5107488674565984, 0.5663094939921007, 0.5640165247908727, 0.5353543599589279, 0.5012364694487091, 0.5032594950604838, 0.3960205761846458, 0.34717142241492954, 0.34419406674687186, 0.28903685579970384, 0.22863814141139308, 0.2101339215866045, 0.23176602330822058, 0.15143395811867955, 0.17741401794998207, 0.35918654957046536, 0.3947528540317245, 0.3830744855249364, 0.41748192385880156, 0.4629094816133078, 0.4488279023166265, 0.45797977664195577, 0.38017209434910193, 0.41373945211708935, 0.40524579898547725, 0.36726033967164, 0.34990815855194857, 0.3617266171769854, 0.3735432268830863, 0.4086387955464682, 0.4412393332138501, 0.4442611485495593, 0.48377782894419297, 0.48807506988462385, 0.483458649016042, 0.48411656695639327, 0.4361391462431778, 0.4463970844929212, 0.4232642840479363, 0.39877291708408136, 0.39907763516950706, 0.3070855399130167, 0.27702260701297476, 0.5924766551447243, 0.6061464057261828, 0.552666450407986, 0.5347810321529773, 0.539673029345713, 0.5275338522262051, 0.5450136858999282, 0.5008649052218808, 0.4833777792753602, 0.43716521843764855, 0.40637657870596133, 0.4361842188473099, 0.4087776285070897, 0.32180880966218006, 0.3483787007947007, 0.37821142909223415, 0.3851336098571978, 0.3779162138002669, 0.3762748373474541, 0.3799478141428553, 0.38742863024913105, 0.3648516243901337, 0.4268476189125212, 0.45617453283777976, 0.4274248752906378, 0.42324850389908686, 0.38240731600197714, 0.3799807705938215, 0.3495259848544926, 0.35212642311985104, 0.33244441157988547, 0.3201737923363542, 0.27696265669560177, 0.1588104887958189, 0.15198690968545564, 0.11268110810071885, 0.32253665677699617, 0.39649222468007417, 0.47103533541362475, 0.4859070749924189, 0.45886823450576625, 0.4295459521761851, 0.40568717439350155, 0.4287915816741504, 0.4164733906864202, 0.4120485818811828, 0.3967732943936393, 0.5317784999420802, 0.5871241644503686, 0.6467321624646484, 0.6123783736014282, 0.5139862583000518, 0.5173668590900491, 0.4986552915908829, 0.5155936244913676, 0.5193555346251346, 0.5529258526197113, 0.5512753742642944, 0.5362842506455211, 0.4492683365894545, 0.30747790320900165, 0.28539691900665554, 0.28096727630696733, 0.30642340758572306, 0.3648373523591582, 0.3939061515844273, 0.4029564747720746, 0.4003351382850695, 0.4394945191021992, 0.4759236533197643, 0.5174728543978978, 0.5422165224933978, 0.5051443737497059, 0.49293825479019876, 0.4674055492310102, 0.5706630770730394, 0.1561404437915221, 0.1969461777980446, 0.22586086730379965, 0.2853973250676186, 0.3571741131473126, 0.40514055783118197, 0.36200807153098646, 0.38437782100459295, 0.3499057534425512, 0.3808799415766744, 0.5227233629860455, 0.5674595659577019, 0.6057209607213461, 0.5586878129686953, 0.5764187685452755]
			EL_switches = [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
			v0 = [0.0, 1.1176470588235294, 1.3137254901960784, 1.4509803921568627, 1.5686274509803921, 1.6666666666666667, 1.7647058823529411, 1.803921568627451, 1.7450980392156863, 1.6862745098039216, 1.607843137254902, 1.5294117647058822, 1.4509803921568627, 1.3725490196078431, 1.2745098039215685, 1.1176470588235294, 0.7843137254901961, 0.6470588235294118, 1.1568627450980393, 1.392156862745098, 1.5294117647058822, 1.6274509803921569, 1.7058823529411764, 1.7058823529411764, 1.6470588235294117, 1.588235294117647, 1.5294117647058822, 1.4705882352941178, 1.392156862745098, 1.2941176470588236, 1.1372549019607843, 0.8431372549019608, 0.5490196078431373, 1.0980392156862746, 1.2941176470588236, 1.411764705882353, 1.4901960784313726, 1.4509803921568627, 1.3725490196078431, 1.2549019607843137, 1.0784313725490196, 0.6470588235294118, 0.7450980392156863, 1.0980392156862746, 1.2745098039215685, 1.392156862745098, 1.4901960784313726, 1.5490196078431373, 1.607843137254902, 1.6470588235294117, 1.6862745098039216, 1.6470588235294117, 1.588235294117647, 1.4901960784313726, 1.3529411764705883, 1.1568627450980393, 0.7254901960784313, 0.7450980392156863, 1.1764705882352942, 1.392156862745098, 1.5490196078431373, 1.6666666666666667, 1.7450980392156863, 1.803921568627451, 1.803921568627451, 1.7647058823529411, 1.7254901960784315, 1.6666666666666667, 1.588235294117647, 1.4901960784313726, 1.3725490196078431, 1.2156862745098038, 0.9411764705882353, 0.43137254901960786, 1.0588235294117647, 1.2745098039215685, 1.411764705882353, 1.5098039215686274, 1.588235294117647, 1.6470588235294117, 1.7058823529411764, 1.7450980392156863, 1.6862745098039216, 1.6274509803921569, 1.5490196078431373, 1.4509803921568627, 1.3137254901960784, 1.1176470588235294, 0.6078431372549019, 0.7843137254901961, 1.0784313725490196, 1.2352941176470589, 1.3529411764705883, 1.4509803921568627, 1.5294117647058822, 1.588235294117647, 1.6470588235294117, 1.588235294117647, 1.5098039215686274, 1.411764705882353, 1.2745098039215685, 1.0784313725490196, 0.5490196078431373, 0.8627450980392157, 1.1764705882352942, 1.3529411764705883, 1.4705882352941178, 1.5686274509803921, 1.6470588235294117, 1.7254901960784315, 1.7843137254901962, 1.8431372549019607, 1.8823529411764706, 1.8431372549019607, 1.803921568627451, 1.7450980392156863, 1.6862745098039216, 1.607843137254902, 1.5098039215686274, 1.392156862745098, 1.2156862745098038, 0.9019607843137255, 0.5294117647058824, 1.1372549019607843, 1.392156862745098, 1.5490196078431373, 1.6470588235294117, 1.7058823529411764, 1.6470588235294117, 1.588235294117647, 1.5098039215686274, 1.411764705882353, 1.2745098039215685, 1.0784313725490196, 0.6666666666666666, 0.7450980392156863, 1.0980392156862746, 1.2549019607843137, 1.3529411764705883, 1.4313725490196079, 1.5098039215686274, 1.5686274509803921, 1.607843137254902, 1.5490196078431373, 1.4705882352941178, 1.392156862745098, 1.2941176470588236, 1.1568627450980393, 0.9019607843137255, 0.47058823529411764, 1.0980392156862746, 1.3137254901960784, 1.4705882352941178, 1.588235294117647, 1.6666666666666667, 1.7254901960784315, 1.7254901960784315, 1.6666666666666667, 1.607843137254902, 1.5490196078431373, 1.4705882352941178, 1.392156862745098, 1.2745098039215685, 1.0980392156862746, 0.7647058823529411, 0.6470588235294118, 1.1568627450980393, 1.3725490196078431, 1.5294117647058822, 1.6274509803921569, 1.7058823529411764, 1.7647058823529411, 1.7058823529411764, 1.6274509803921569, 1.5294117647058822, 1.4313725490196079, 1.3333333333333333, 1.2156862745098038, 1.0588235294117647, 0]

		if case == 2:
			# Liver
			irr_times = [0.17081812012565767, 0.1737692416407477, 0.17626992979468845, 0.17069944640464702, 0.1777516668399738, 0.16289403275607242, 0.16728595029036122, 0.15472737540698228, 0.13766284400208642, 0.12250214484819123, 0.10128525830142511, 0.12523729129168032, 0.1187625718444401, 0.09102650620463454, 0.0902727964043962, 0.14963570091430164, 0.17971648765801385, 0.18472963411489562, 0.17575084098684993, 0.16059785157193315, 0.12066913663459017, 0.13608677316372036, 0.14151905991042554, 0.14117469780613326, 0.10521805033112776, 0.11675319564683706, 0.12611527770251452, 0.09001068201842452, 0.07714574567571869, 0.038331711898883535, 0.16877068106771723, 0.20350296998443557, 0.1849734999554614, 0.16338485933543245, 0.1489135897542914, 0.15658682771564836, 0.1569645889896191, 0.15271299389266568, 0.14218424122972895, 0.1468673458611548, 0.11833214673991899, 0.09854818776817689, 0.08634674074371146, 0.10035020248044631, 0.0609977709746279, 0.2622497548422099, 0.2448564411549591, 0.19377412576380984, 0.1992605891746071, 0.20124725690597395, 0.1857181874810865, 0.1723312597072529, 0.13226837673853833, 0.15812321668735402, 0.13450314363989072, 0.0912790570950587, 0.09918577076494013, 0.09422803692302828, 0.06391623954547092, 0.02762492414492354, 0.19440059967256232, 0.195731015332978, 0.17720679312614349, 0.16539906799401424, 0.16404546285228944, 0.14751905916909944, 0.16311271596949892, 0.16310236207544035, 0.15022887848401856, 0.17582515757377834, 0.12864975150243382, 0.15736285672795491, 0.13870058644997074, 0.14341893876585265, 0.13628076614720047, 0.15185205644800265, 0.16978010220382705, 0.17075218220826774, 0.17963027611586882, 0.18691640409768456, 0.19813308257189063, 0.1880125335144836, 0.16196639434753682, 0.1367653224663154, 0.13118630224375982, 0.14669117882942068, 0.16433266138634697, 0.16138990583890317, 0.16460387872721516, 0.12745060279313797, 0.1671557094137823, 0.15647853871542206, 0.16698608769234138, 0.1612568538728719, 0.15392743178943366, 0.16832814778527008, 0.16476505143462594, 0.18074642287629053, 0.17071736186524117, 0.17883482372848503, 0.18953474680796772, 0.15675233266901933, 0.14425906627391905, 0.119237662178191, 0.1192418048426619, 0.1601033679814396, 0.17049422353899324, 0.16005989790974534, 0.15490467788401477, 0.16098674498203025, 0.13871398622257586, 0.1312900266832617, 0.13058810589861705, 0.14526284246852023, 0.17687876537827793, 0.17813594606601996, 0.1705088922744919, 0.16931289437152777, 0.1573643984222259, 0.11467734933454143, 0.14980951395507497, 0.16009955219268118, 0.16727244933116142, 0.1582545760311687, 0.15766797162630317, 0.1604857994459198, 0.16434190002456917, 0.15978850020049593, 0.1648161954748056, 0.1715680476712559, 0.16350496152090155, 0.15094149052163103, 0.14896712634175246, 0.1363133306425037, 0.11053209895221405, 0.17826488489041994, 0.18363463112446796, 0.18165473534798424, 0.20380896451369904, 0.20146183630545983, 0.1825842243199569, 0.15775852048870906, 0.1582518618239062, 0.17435163748945917, 0.1550126750570398, 0.1652597663344938, 0.17365907567350272, 0.17255840434074124, 0.13178838389846143, 0.11669068324274125, 0.2155528251573514, 0.26376911150340976, 0.2564972136178726, 0.25929152346124595, 0.23083861362990407, 0.20111887386600857, 0.1896658331763921, 0.1613405995920917, 0.15917829872088782, 0.14434764014864127, 0.13421055141616278, 0.13845912489114137, 0.13173208859748634, 0.10503163647264074, 0.11076082317926575, 0.1930821311997911, 0.2061607865167862, 0.20920004045198584, 0.1979321340469572, 0.18692959853596638, 0.1880863410820627, 0.17759554241719003, 0.15963644838447283, 0.14614410550485737, 0.16105741799853018, 0.15123918074958534, 0.136167666220821, 0.1146114567623072, 0.12019572620281271, 0.06475679625533205]
			EL_switches = [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 5.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
			v0 = [0.0, 1.1372549019607843, 1.3725490196078431, 1.5490196078431373, 1.6862745098039216, 1.803921568627451, 1.9019607843137254, 1.9803921568627452, 1.9607843137254901, 1.8627450980392157, 1.7450980392156863, 1.607843137254902, 1.4313725490196079, 1.196078431372549, 0.6862745098039216, 0.8235294117647058, 1.2156862745098038, 1.4313725490196079, 1.588235294117647, 1.7058823529411764, 1.8235294117647058, 1.9215686274509804, 2.0, 1.9803921568627452, 1.8823529411764706, 1.7647058823529411, 1.6274509803921569, 1.4509803921568627, 1.2156862745098038, 0.7254901960784313, 0.7843137254901961, 1.196078431372549, 1.411764705882353, 1.5686274509803921, 1.7058823529411764, 1.8235294117647058, 1.9215686274509804, 2.0, 1.9607843137254901, 1.8627450980392157, 1.7450980392156863, 1.607843137254902, 1.4313725490196079, 1.196078431372549, 0.6666666666666666, 0.8235294117647058, 1.196078431372549, 1.411764705882353, 1.5686274509803921, 1.6862745098039216, 1.7843137254901962, 1.8823529411764706, 1.9607843137254901, 1.9803921568627452, 1.8823529411764706, 1.7647058823529411, 1.6274509803921569, 1.4509803921568627, 1.196078431372549, 0.6470588235294118, 0.8431372549019608, 1.2156862745098038, 1.4313725490196079, 1.588235294117647, 1.7058823529411764, 1.8235294117647058, 1.9215686274509804, 2.0, 1.9411764705882353, 1.8431372549019607, 1.7450980392156863, 1.6274509803921569, 1.4705882352941178, 1.2549019607843137, 0.8823529411764706, 0.6078431372549019, 1.1568627450980393, 1.392156862745098, 1.5490196078431373, 1.6862745098039216, 1.7843137254901962, 1.8823529411764706, 1.9607843137254901, 1.9411764705882353, 1.8431372549019607, 1.7254901960784315, 1.588235294117647, 1.4313725490196079, 1.2156862745098038, 0.803921568627451, 0.6862745098039216, 1.1764705882352942, 1.411764705882353, 1.5686274509803921, 1.7058823529411764, 1.8235294117647058, 1.9215686274509804, 2.0, 1.9215686274509804, 1.8431372549019607, 1.7450980392156863, 1.6274509803921569, 1.4705882352941178, 1.2549019607843137, 0.8823529411764706, 0.6078431372549019, 1.1568627450980393, 1.392156862745098, 1.5686274509803921, 1.7058823529411764, 1.8235294117647058, 1.9215686274509804, 2.0, 1.9215686274509804, 1.8235294117647058, 1.7254901960784315, 1.607843137254902, 1.4509803921568627, 1.2549019607843137, 0.8823529411764706, 0.6078431372549019, 1.1568627450980393, 1.392156862745098, 1.5686274509803921, 1.7058823529411764, 1.8235294117647058, 1.9215686274509804, 2.0, 1.9215686274509804, 1.8235294117647058, 1.7254901960784315, 1.588235294117647, 1.4313725490196079, 1.196078431372549, 0.7254901960784313, 0.7647058823529411, 1.196078431372549, 1.411764705882353, 1.5686274509803921, 1.6862745098039216, 1.7843137254901962, 1.8823529411764706, 1.9607843137254901, 1.9215686274509804, 1.8235294117647058, 1.7058823529411764, 1.588235294117647, 1.4313725490196079, 1.2156862745098038, 0.7843137254901961, 0.7058823529411765, 1.1568627450980393, 1.3725490196078431, 1.5294117647058822, 1.6470588235294117, 1.7450980392156863, 1.8431372549019607, 1.9215686274509804, 1.9411764705882353, 1.8431372549019607, 1.7254901960784315, 1.588235294117647, 1.411764705882353, 1.1568627450980393, 0.5882352941176471, 0.8823529411764706, 1.2352941176470589, 1.4313725490196079, 1.588235294117647, 1.7058823529411764, 1.803921568627451, 1.9019607843137254, 1.9803921568627452, 1.9215686274509804, 1.8235294117647058, 1.7254901960784315, 1.588235294117647, 1.411764705882353, 1.1568627450980393, 0]
		
		xs0 = [v0[i]*irr_times[i] for i in range(len(v0))]

		print(len(irr_times), len(EL_switches), len(control_points))


		dead_times = obj_rucking(xs0, v0, EL_switches, irr_times)

		#plt.plot(dead_times)
		#plt.plot(v0)
		for inner in [0, 2]:
			if inner == 2:
				dead_times = fancy_dead_times
				v0 = fancy_vels

			plt.subplot(2, 2, 1 + inner)
			plt.xlim([-10, 370])
			plt.ylim([-0.1, 3])
			plt.scatter([2*i+1 for i in range(len(dead_times))], dead_times, 1, c=palette[4], label="Lost time")
			plt.scatter([2*i for i in range(len(v0))], v0, 1, c=palette[1], label="Irradiation Velocities")
			if inner == 2:
				plt.xlabel("Gantry angle [°]")
				plt.title("ATOM with Local Search")
			if inner == 0:
				plt.title("Velocity and Lost Time of the Prostate Case\nATOM")
				plt.tick_params(left = False, right = False , labelleft = True , labelbottom = False, bottom = False)

				plt.legend()
			plt.ylabel("Velocity [°/s] and Lost Time [s]")
			print(len(v0), len(dead_times))
			delta_vs = [v0[i+1] - v0[i] for i in range(len(v0)-1)]
			plt.subplot(2, 2, 2 + inner)
			plt.xlim([-1.5, 1.5])
			plt.ylim([-0.1, 3])
			vals = np.linspace(0, 1, 100)
			b = 0.99
			a = 2.4 - b
			if inner == 0:
				plt.title("Lost Time vs $\Delta V$\nATOM")
				plt.tick_params(left = False, right = False , labelleft = True , labelbottom = False, bottom = False) 
			plt.ylabel("Lost Time [s]")
			if inner == 2:
				plt.title("ATOM with Local Search")
				plt.xlabel("$\Delta V$ [°/s]")
			#plt.plot(vals, a*np.sqrt(vals) + b*vals, "green")
			plt.scatter(delta_vs, dead_times, 1, alpha=0.5, c=palette[5])
	plt.show()
